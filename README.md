# Block Blast JS

ブロックブラストゲームのWebバージョンです。HTML5、CSS3、JavaScriptを使用して作成された完全に動作するパズルゲームです。

## 🎮 ゲームの特徴

- **10x10のゲームボード**: クラシックなブロックパズルゲームの体験
- **豊富なブロック形状**: 25種類以上のバラエティに富んだブロック
  - 基本形状：単体、正方形、I字形、L字形、T字形、Z字形、十字形
  - テトリス7種：標準的なテトリスブロック（I、O、T、J、L、S、Z）
  - **特殊ブロック「山」「口」**: 赤色で特別なボーナス付き
  - 創作形状：大きなL字形、階段形、ダイヤ形、U字形、矢印形など
- **直感的な操作**: ドラッグアンドドロップでブロックを配置
- **ゴースト表示機能**: ブロック配置時に半透明のプレビューを表示
- **行・列消去機能**: 完全に埋まった行や列を自動削除
- **スコアシステム**: ライン消去数に応じたスコア計算
- **レスポンシブデザイン**: モバイルデバイスにも対応
- **タッチ操作対応**: スマートフォンやタブレットでも快適にプレイ可能

## 🚀 現在実装済みの機能

### ✅ 完全に実装済み

#### 🌟 NEW! 特殊ブロック機能

1. **「山」形ブロック（5x3）**
   - 特殊な赤色グラデーション
   - 配置時に+200点の特別ボーナス
   - 光るエフェクトと特別なアニメーション
   - 10%の確率でランダム出現

2. **「口」形ブロック（3x3中空）**
   - 中央が空いた正方形
   - 特殊な赤色グラデーション
   - 配置時に+200点の特別ボーナス
   - 光るエフェクトと特別なアニメーション
   - 10%の確率でランダム出現

3. **テトリス標準7種**
   - クラシックなテトリスの7つの基本形状
   - テトリス準拠の公式カラーリング
   - I、O、T、J、L、S、Zの完全セット

4. **創作ブロック形状**
   - 大きなL字形（4x4）、階段形、ダイヤ形
   - U字形、矢印形、小さな十字形
   - 戦略性を高める多様な配置パターン

1. **ゲームボード**
   - 10x10グリッドの描画
   - セルの状態管理（空/埋まり）
   - 美しいビジュアルデザイン

2. **ブロック管理**
   - 15種類の多様なブロック形状
   - ランダムなブロック生成
   - カラフルなブロック表示

3. **ドラッグアンドドロップ機能**
   - スムーズなマウス操作
   - タッチ操作対応
   - ブロックの配置判定

4. **ゴースト表示システム**
   - 配置可能位置の半透明プレビュー
   - リアルタイムでの位置更新
   - 配置不可能時の適切な表示制御

5. **待機エリアのUI改善**
   - 大きなブロック（5x5まで）に対応したコンテナサイズ
   - 動的なレイアウト調整
   - 配置不可能ブロックの視覚的表示
   - **特殊ブロック専用の視覚表示**：
     - 赤い枠線とグラデーション背景
     - 右上角に✨マーク
     - 光るアニメーション効果
     - ホバー時の特別エフェクト

6. **ゲームロジック**
   - 行・列の完成判定
   - 自動削除アニメーション
   - 連続削除（コンボ）機能
   - **拡張スコアシステム**：
     - 基本スコア：100点
     - ライン削除ボーナス：50点 x ライン数
     - コンボボーナス：100点 x (コンボ数 - 1)
     - **特殊ブロックボーナス：+200点**
     - 特殊ブロック配置時の専用エフェクト

7. **ユーザーエクスペリエンス**
   - スコア表示とポップアップアニメーション
   - **特殊ブロック専用のスコア表示**：
     - ✨マーク付きの特別なポップアップ
     - 黄金の枠線と赤いグラデーション
     - 「特殊ブロックボーナス！」メッセージ
   - ゲームオーバー判定
   - 新ゲーム機能
   - 直感的な操作フィードバック
   - **特殊ブロック配置時のパルスエフェクト**

## 🎯 解決された問題

### 1. ゴースト表示バグの修正
- **問題**: ブロックを上方向に持っていけない、ゴースト表示が正しく動作しない
- **解決**: 
  - 座標計算を正確に修正
  - ゲームボードの位置とマウス座標の正確な変換
  - パディングとギャップを考慮した計算

### 2. 待機場所UIの改善
- **問題**: ブロックの待機場所のUIが崩れている、大きいブロックに対応していない
- **解決**:
  - 待機コンテナサイズを200x200pxに拡大
  - 5x5までの大型ブロックに対応
  - 中央配置とフレキシブルレイアウト
  - ホバー効果とアニメーション追加

## 📁 ファイル構成

```
block-blast-js/
├── index.html              # メインHTML
├── css/
│   └── style.css          # スタイルシート
└── js/
    ├── blockShapes.js     # ブロック形状定義
    ├── dragAndDrop.js     # ドラッグ機能とゴースト表示
    ├── gameLogic.js       # ゲームロジック
    └── main.js            # メインエントリーポイント
```

## 🎨 技術的なハイライト

### 特殊ブロックシステム
```javascript
// 特殊ブロック「山」の定義
mountainShape: {
    pattern: [
        [0, 0, 1, 0, 0],
        [1, 0, 1, 0, 1],
        [1, 1, 1, 1, 1]
    ],
    color: '#ef4444',
    special: true  // 特殊フラグ
}

// 特殊ブロック「口」の定義
squareHollow: {
    pattern: [
        [1, 1, 1],
        [1, 0, 1],
        [1, 1, 1]
    ],
    color: '#ef4444',
    special: true
}
```

### 動的出現率制御
```javascript
// 特殊ブロックは10%の確率で出現
if (Math.random() < 0.1) {
    // 特殊ブロックを選択
} else {
    // 通常ブロックを選択
}
```

### ゴースト表示システム
```javascript
// リアルタイムでのブロック配置プレビュー
function showGhostPreview(startRow, startCol, pattern) {
    // 半透明のセルを動的に生成
    // ボード座標と画面座標の正確な変換
    // 配置可能性の即座な判定
}
```

### 待機エリアの動的サイズ調整
```css
.waiting-block-container {
    width: 200px;
    height: 200px;
    display: flex;
    justify-content: center;
    align-items: center;
    /* 大型ブロック（5x5）にも対応 */
}
```

## 🚀 今後の拡張可能性

- **新しい特殊ブロック**: 「田」「工」「凹」「凸」形状の追加
- **特殊効果ブロック**: 爆弾ブロック（周囲を消去）、虹色ブロック（任意の色に変化）
- **パワーアップシステム**: 特殊ブロック使用によるパワーアップ獲得
- **レベルシステム**: 特殊ブロック出現率の変化する難易度調整
- **コンボシステム**: 特殊ブロック連続使用での追加ボーナス
- **サウンド効果**: 特殊ブロック専用の配置音と削除音
- **アチーブメント**: 「山師」「口上手」などの称号システム
- **ハイスコア記録**: 通常スコアと特殊ブロックスコアの分離記録
- **カスタムブロック**: プレイヤー作成の独自ブロック形状

## 💻 動作環境

- **ブラウザ**: Chrome, Firefox, Safari, Edge（最新版）
- **デバイス**: PC、タブレット、スマートフォン
- **要件**: JavaScript有効なモダンブラウザ

## 🎮 遊び方

1. 画面右側の待機エリアからブロックをドラッグ
2. ゲームボード上でゴースト表示を確認
3. 適切な位置でドロップしてブロックを配置
4. 行または列が完全に埋まると自動的に削除される
5. 配置できるブロックがなくなったらゲームオーバー

## 📞 開発者向け情報

このプロジェクトはピュアなHTML/CSS/JavaScriptで構築されており、追加の依存関係はありません。コードは模組化されており、各機能が独立したファイルに分割されているため、メンテナンスや拡張が容易です。

---

## 📊 ブロック統計

- **総ブロック数**: 25種類
- **基本ブロック**: 15種類
- **テトリスブロック**: 7種類
- **特殊ブロック**: 2種類（山・口）
- **創作ブロック**: 6種類
- **最大サイズ**: 5x5（山形ブロック）
- **特殊ブロック出現率**: 10%
- **特殊ブロックボーナス**: +200点

---

**Status**: ✅ 完全動作可能（特殊ブロック機能付き）  
**Version**: 2.0.0  
**Last Updated**: 2025-10-09  
**New Features**: 山・口特殊ブロック、テトリス7種、25種類のバラエティ豊かなブロック形状